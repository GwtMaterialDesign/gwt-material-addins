!function(){var t=window.jQuery;k.DEFAULTS={startTime:"",autoclose:!1,vibrate:!0,hour24:!1,orientation:"portrait",cancelText:"CANCEL",okText:"OK"};var i="ontouchstart"in window,o="mousedown"+(i?" touchstart":""),l="mousemove.lolliclock"+(i?" touchmove.lolliclock":""),e="mouseup.lolliclock"+(i?" touchend.lolliclock":""),s=navigator.vibravarte?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,n="http://www.w3.org/2000/svg";function a(t){return document.createElementNS(n,t)}function c(t){return(t<10?"0":"")+t}var d=0;var r=84,h=50,u=70,p=12,m=2*r,v=350,f=['<div id="time-picker" class="clock-overlay">','<div class="lolliclock-popover">','<div class="lolliclock-header">','<div class="lolliclock-time">','<div class="lolliclock-hours lolliclock-primary-text">','<div class="lolliclock-time-old"></div>','<div class="lolliclock-time-new"></div>',"</div>",'<span class="lolliclock-colon">:</span>','<div class="lolliclock-minutes">','<div class="lolliclock-time-old"></div>','<div class="lolliclock-time-new"></div>',"</div>","</div>",'<span class="lolliclock-am-pm"></span>',"</div>",'<div class="popover-content">','<div class="lolliclock-plate">','<div class="lolliclock-canvas"></div>','<div class="lolliclock-dial lolliclock-dial-hours"></div>','<div class="lolliclock-dial lolliclock-dial-minutes lolliclock-dial-out"></div>',"</div>",'<div class="lolliclock-ampm-block">','<div id="lolliclock-btn-am" class="lolliclock-ampm-btn">','<div class="lolliclock-btn-background"></div>','<div class="lolliclock-btn-text">AM</div>',"</div>",'<div style="flex: 1;"></div>','<div id="lolliclock-btn-pm" class="lolliclock-ampm-btn">','<div class="lolliclock-btn-background"></div>','<div class="lolliclock-btn-text">PM</div>',"</div>","</div>","</div>","</div>","</div>"].join("");function k(i,s){var n,k,w=t(f),b=w.find(".lolliclock-popover"),A=w.find(".lolliclock-plate"),M=w.find(".lolliclock-dial-hours"),C=w.find(".lolliclock-dial-minutes"),y="INPUT"===i.prop("tagName"),P=y?i:i.find("input"),T=this;if(this.id=(k=++d+"",(n="lolli")?n+k:k),this.element=i,this.options=s,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=y,this.input=P,this.popover=w,this.plate=A,this.hoursView=M,this.minutesView=C,this.header=w.find(".lolliclock-header"),this.spanHours=w.find(".lolliclock-hours"),this.spanMinutes=w.find(".lolliclock-minutes"),this.spanNewTime=w.find(".lolliclock-time-new"),this.spanOldTime=w.find(".lolliclock-time-old"),this.spanAmPm=w.find(".lolliclock-am-pm"),this.amOrPm="PM",this.AmPmButtons=w.find(".lolliclock-ampm-btn"),this.amButton=w.find("#lolliclock-btn-am"),this.pmButton=w.find("#lolliclock-btn-pm"),this.options.hour24&&(this.AmPmButtons.hide(),this.spanAmPm.hide()),w.addClass(this.options.orientation),!s.autoclose){this.popover.css("height","380px");var x=t('<div class="lolliclock-buttons"></div>').appendTo(b);t('<div class="lolliclock-button">'+s.cancelText+"</div>").click(t.proxy(this.hide,this)).appendTo(x),t('<div class="lolliclock-button">'+s.okText+"</div>").click(t.proxy(this.done,this)).appendTo(x),this.closeButtons=w.find(".lolliclock-button")}P.on("focus.lolliclock click.lolliclock",t.proxy(this.show,this));var V,E,B,N=t('<div class="lolliclock-tick"></div>');if(s.hour24){for(V=1;V<13;V++)E=N.clone(),B=V/6*Math.PI,E.css({left:r+Math.sin(B)*h-p,top:r-Math.cos(B)*h-p}),E.html(V),M.append(E);for(V=13;V<=24;V++)E=N.clone(),B=V/6*Math.PI,E.css({left:r+Math.sin(B)*u-p,top:r-Math.cos(B)*u-p}),24===V?E.html("00"):E.html(V),M.append(E)}else for(V=1;V<13;V++)E=N.clone(),B=V/6*Math.PI,E.css({left:r+Math.sin(B)*u-p,top:r-Math.cos(B)*u-p}),E.html(V),M.append(E);for(V=0;V<60;V+=5)E=N.clone(),B=V/30*Math.PI,E.css({left:r+Math.sin(B)*u-p,top:r-Math.cos(B)*u-p}),E.html(c(V)),C.append(E);A.on(o,function(i){var o=A.offset(),n=/^touch/.test(i.type),a=o.left+r,c=o.top+r,d=(n?i.originalEvent.touches[0]:i).pageX-a,m=(n?i.originalEvent.touches[0]:i).pageY-c,f=Math.sqrt(d*d+m*m),k=!1;if(outsideMode=!0,f<u+p&&f>u-p)outsideMode=!0;else{if(!(f>h-p&&f<h+p&&s.hour24&&"hours"===T.currentView))return;outsideMode=!1}i.preventDefault(),t(document.body).addClass("lolliclock-moving"),A.append(T.canvas),T.setHand(d,m,outsideMode),t(document).off(l).on(l,function(t){t.preventDefault();var i=/^touch/.test(t.type),o=(i?t.originalEvent.touches[0]:t).pageX-a,l=(i?t.originalEvent.touches[0]:t).pageY-c;(k||o!==d||l!==m)&&(k=!0,T.setHand(o,l,outsideMode))}),t(document).off(e).on(e,function(i){i.preventDefault();var o=/^touch/.test(i.type),n=(o?i.originalEvent.changedTouches[0]:i).pageX-a,r=(o?i.originalEvent.changedTouches[0]:i).pageY-c;n===d&&r===m&&T.setHand(n,r,outsideMode),"hours"===T.currentView?T.toggleView("minutes",v/2):s.autoclose&&T.done(),A.prepend(S),t(document.body).removeClass("lolliclock-moving"),t(document).off(l),t(document).off(e)})});var S=w.find(".lolliclock-canvas"),H=a("svg");H.setAttribute("class","lolliclock-svg"),H.setAttribute("width",m),H.setAttribute("height",m);var O=a("g");O.setAttribute("transform","translate("+r+","+r+")");var D=a("circle");D.setAttribute("class","lolliclock-bearing"),D.setAttribute("cx",0),D.setAttribute("cy",0),D.setAttribute("r",1.25);var I=a("line");I.setAttribute("x1",0),I.setAttribute("y1",0);var L=a("circle");L.setAttribute("class","lolliclock-canvas-bg"),L.setAttribute("r",p);var X=a("circle");X.setAttribute("class","lolliclock-canvas-fg"),X.setAttribute("r",3.5),O.appendChild(I),O.appendChild(L),O.appendChild(X),O.appendChild(D),H.appendChild(O),S.append(H),this.hand=I,this.bg=L,this.fg=X,this.bearing=D,this.g=O,this.canvas=S,g(this.options.init)}function g(t){t&&"function"==typeof t&&t()}k.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},k.prototype.setOrientation=function(t){this.popover.removeClass(this.options.orientation),this.options.orientation=t,this.popover.addClass(t)},k.prototype.changeAmPm=function(i){i&&i===this.amOrPm&&this.options.hour24||(this.amOrPm="AM"===this.amOrPm?"PM":"AM",this.spanAmPm.html(this.amOrPm),t(this.amButton[0].childNodes[0]).toggleClass("lolliclock-active-button-background","AM"===this.amOrPm),t(this.pmButton[0].childNodes[0]).toggleClass("lolliclock-active-button-background","PM"===this.amOrPm),t(this.amButton[0].childNodes[1]).toggleClass("lolliclock-active-button-text","AM"===this.amOrPm),t(this.pmButton[0].childNodes[1]).toggleClass("lolliclock-active-button-text","PM"===this.amOrPm))},k.prototype.locate=function(){var i=this.element,o=this.popover,l=i.offset().left+(i.outerWidth()-o.width())/2,e=t(window).width()-o.width()-8,s=t(window).height()+t(window).scrollTop()-8-o.height(),n=8+t(window).scrollTop(),a=i.offset().top,c={};c.top=a<n?n:a>s?s:a,c.left=l<8?8:l>e?e:l,o.css(c),o.show()},k.prototype.show=function(){var i=this;setTimeout(function(){if(!i.isShown){g(i.options.beforeShow);var o,l=i;i.popover.addClass(i.options.orientation),i.isAppended||(t(document.body).append(i.popover),i.isAppended=!0,t(window).on("resize.lolliclock"+i.id,function(){l.isShown&&l.locate()}),t(window).on("scroll.lolliclock",function(){l.isShown&&l.locate()}),i.AmPmButtons.on("click",function(t){l.changeAmPm(t.currentTarget.children[1].innerHTML)}),i.spanMinutes.on("click",function(){l.toggleView("minutes")}),i.spanHours.on("click",function(){l.toggleView("hours")}),i.spanAmPm.on("click",function(){l.changeAmPm()})),l.locate(),i.plate.addClass("animate"),i.header.addClass("animate"),i.popover.addClass("animate"),i.AmPmButtons.addClass("animate"),i.spanNewTime.addClass("animate"),i.spanOldTime.addClass("animate"),!i.options.autoclose&&i.closeButtons.addClass("animate"),i.plate.on("webkitAnimationEnd animationend MSAnimationEnd oanimationend",function(){l.plate.removeClass("animate"),l.header.removeClass("animate"),l.popover.removeClass("animate"),l.AmPmButtons.removeClass("animate"),l.spanNewTime.removeClass("animate"),l.spanOldTime.removeClass("animate"),!l.options.autoclose&&l.closeButtons.removeClass("animate"),l.plate.off("webkitAnimationEnd animationend MSAnimationEnd oanimationend")});var e=i.input.prop("value"),s=i.options.startTime,n=i.input.prop("placeholder");o=e&&c(e)?a(e):"now"===s?new Date:s&&c(s)?a(s):n&&c(n)?a(n):new Date,i.options.hour24?i.hours=o.getHours():(i.hours=o.getHours()%12,i.amOrPm=o.getHours()>11?"AM":"PM"),i.minutes=o.getMinutes(),i.changeAmPm(),l.toggleView("minutes"),l.toggleView("hours"),l.isShown=!0,t(document).on("click.lolliclock."+i.id+" focusin.lolliclock."+i.id,function(i){var o=t(i.target);0===o.closest(l.popover).length&&0===o.closest(l.input).length&&l.done()}),t(document).on("keyup.lolliclock."+i.id,function(t){27===t.keyCode&&l.hide()}),g(i.options.afterShow)}function a(t){var i=t.split(":");if(2===i.length){var o=+i[0],l=i[1].split(" ");if(2===l.length){var e=l[0];return"PM"===l[1]&&(o+=12),new Date(1970,1,1,o,e)}}return new Date("x")}function c(t){return!isNaN(a(t).getTime())}},100)},k.prototype.hide=function(){g(this.options.beforeHide);var i=this;i.popover.addClass("animate-out"),i.plate.addClass("animate-out"),i.header.addClass("animate-out"),i.AmPmButtons.addClass("animate-out"),!i.options.autoclose&&i.closeButtons.addClass("animate-out"),this.popover.on("webkitAnimationEnd animationend MSAnimationEnd oanimationend",function(){t(i.spanHours[0].childNodes[0]).html(""),t(i.spanMinutes[0].childNodes[0]).html(""),i.popover.removeClass("animate-out"),i.plate.removeClass("animate-out"),i.header.removeClass("animate-out"),i.AmPmButtons.removeClass("animate-out"),!i.options.autoclose&&i.closeButtons.removeClass("animate-out"),i.popover.off("webkitAnimationEnd animationend MSAnimationEnd oanimationend"),t(document).off("click.lolliclock."+i.id+" focusin.lolliclock."+i.id),t(document).off("keyup.lolliclock."+i.id),i.popover.hide(),g(i.options.afterHide)}),i.isShown=!1},k.prototype.toggleView=function(i,o){var e="hours"===i,s=e?this.hoursView:this.minutesView,n=e?this.minutesView:this.hoursView;if(this.currentView=i,this.spanHours.toggleClass("lolliclock-primary-text",e),this.spanMinutes.toggleClass("lolliclock-primary-text",!e),n.addClass("lolliclock-dial-out"),s.css("visibility","visible").removeClass("lolliclock-dial-out"),this.resetClock(o),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){n.css("visibility","hidden")},v),e)this.plate.off(l);else{var a=this;this.plate.on(l,function(i){var o=a.plate.offset(),l=o.left+r,e=o.top+r,s=i.pageX-l,n=i.pageY-e,c=Math.sqrt(s*s+n*n);c>u-p&&c<u+p?t(document.body).addClass("lolliclock-clickable"):t(document.body).removeClass("lolliclock-clickable")})}},k.prototype.resetClock=function(t){var i=this.currentView,o=!0,l=this[i];"hours"===i?(unit=Math.PI/6,0!==l&&l<=12&&this.options.hour24&&(o=!1)):unit=Math.PI/30;var e=l*unit,s=Math.sin(e)*h,n=-Math.cos(e)*h,a=this;t?(a.canvas.addClass("lolliclock-canvas-out"),setTimeout(function(){a.canvas.removeClass("lolliclock-canvas-out"),a.setHand(s,n,o)},t)):this.setHand(s,n,o)},k.prototype.setHand=function(i,o,l){var e,n,a,d=Math.atan2(-i,o)+Math.PI,r="hours"===this.currentView,m=Math.PI/(r?6:30);if(l&&this.options.hour24&&r?12===(e=Math.round(d/m))||0===e?e=0:e+=12:e=Math.round(d/m),d=e*m,r)0!==e||this.options.hour24&&l||(e=12),this.fg.style.visibility="hidden";else{var v=e%5==0;this.fg.style.visibility=v?"hidden":"visible",60===e&&(e=0)}this[this.currentView]!==e&&s&&this.options.vibrate&&(this.vibrateTimer||(navigator[s](10),this.vibrateTimer=setTimeout(t.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=e,r?(n=t(this.spanHours[0].childNodes[0]),a=t(this.spanHours[0].childNodes[1]),this.options.hour24&&(e=c(e))):(n=t(this.spanMinutes[0].childNodes[0]),a=t(this.spanMinutes[0].childNodes[1]),e=c(e)),n.on("webkitAnimationEnd animationend MSAnimationEnd oanimationend",function(){n.html(e),n.removeClass("old-down old-up"),a.removeClass("new-down new-up"),n.off("webkitAnimationEnd animationend MSAnimationEnd oanimationend")}),e<+n.html()?(a.html(n.html()),n.html(e),a.addClass("new-down"),n.addClass("old-down")):(e>+n.html()||!n.html())&&(a.html(e),n.addClass("old-up"),a.addClass("new-up")),this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","lolliclock-canvas-bg");var f=h;l&&(f=u);var k=Math.sin(d)*f,g=-Math.cos(d)*f;this.hand.setAttribute("x2",Math.sin(d)*(f-p)),this.hand.setAttribute("y2",-Math.cos(d)*(f-p)),this.bg.setAttribute("cx",k),this.bg.setAttribute("cy",g),this.fg.setAttribute("cx",k),this.fg.setAttribute("cy",g)},k.prototype.done=function(){g(this.options.beforeDone);var t=this.input.prop("value"),i="";(i=this.options.hour24?c(this.hours)+":"+c(this.minutes):this.hours+":"+c(this.minutes)+" "+this.amOrPm)!==t&&(this.input.prop("value",i),this.input.trigger("input"),this.input.trigger("change")),this.hide()},k.prototype.remove=function(){this.element.removeData("lolliclock"),this.input.off("focus.lolliclock click.lolliclock"),this.isShown&&this.hide(),this.isAppended&&(t(window).off("resize.lolliclock"+this.id),t(window).off("scroll.lolliclock"+this.id),this.popover.remove())},t.fn.lolliclock=function(i){var o=Array.prototype.slice.call(arguments,1);return this.each(function(){var l=t(this),e=l.data("lolliclock");if(e)"function"==typeof e[i]&&e[i].apply(e,o);else{var s=t.extend({},k.DEFAULTS,l.data(),"object"==typeof i&&i);l.data("lolliclock",new k(l,s))}})}}();