!function(){var y=window.jQuery;l.DEFAULTS={startTime:"",autoclose:!1,vibrate:!0,hour24:!1,orientation:"portrait",cancelText:"CANCEL",okText:"OK"};var t="ontouchstart"in window,P="mousedown"+(t?" touchstart":""),T="mousemove.lolliclock"+(t?" touchmove.lolliclock":""),x="mouseup.lolliclock"+(t?" touchend.lolliclock":""),p=navigator.vibravarte?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,i="http://www.w3.org/2000/svg";function V(t){return document.createElementNS(i,t)}function E(t){return(t<10?"0":"")+t}var B=0;var S=84,N=50,H=70,O=12,D=2*S,I=350,L=['<div id="time-picker" class="clock-overlay">','<div class="lolliclock-popover">','<div class="lolliclock-header">','<div class="lolliclock-time">','<div class="lolliclock-hours lolliclock-primary-text">','<div class="lolliclock-time-old"></div>','<div class="lolliclock-time-new"></div>',"</div>",'<span class="lolliclock-colon">:</span>','<div class="lolliclock-minutes">','<div class="lolliclock-time-old"></div>','<div class="lolliclock-time-new"></div>',"</div>","</div>",'<span class="lolliclock-am-pm"></span>',"</div>",'<div class="popover-content">','<div class="lolliclock-plate">','<div class="lolliclock-canvas"></div>','<div class="lolliclock-dial lolliclock-dial-hours"></div>','<div class="lolliclock-dial lolliclock-dial-minutes lolliclock-dial-out"></div>',"</div>",'<div class="lolliclock-ampm-block">','<div id="lolliclock-btn-am" class="lolliclock-ampm-btn">','<div class="lolliclock-btn-background"></div>','<div class="lolliclock-btn-text">AM</div>',"</div>",'<div style="flex: 1;"></div>','<div id="lolliclock-btn-pm" class="lolliclock-ampm-btn">','<div class="lolliclock-btn-background"></div>','<div class="lolliclock-btn-text">PM</div>',"</div>","</div>","</div>","</div>","</div>"].join("");function l(t,h){var i,o,s=y(L),e=s.find(".lolliclock-popover"),r=s.find(".lolliclock-plate"),l=s.find(".lolliclock-dial-hours"),n=s.find(".lolliclock-dial-minutes"),a="INPUT"===t.prop("tagName"),c=a?t:t.find("input"),d=this;if(this.id=(o=++B+"",(i="lolli")?i+o:o),this.element=t,this.options=h,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=a,this.input=c,this.popover=s,this.plate=r,this.hoursView=l,this.minutesView=n,this.header=s.find(".lolliclock-header"),this.spanHours=s.find(".lolliclock-hours"),this.spanMinutes=s.find(".lolliclock-minutes"),this.spanNewTime=s.find(".lolliclock-time-new"),this.spanOldTime=s.find(".lolliclock-time-old"),this.spanAmPm=s.find(".lolliclock-am-pm"),this.amOrPm="PM",this.AmPmButtons=s.find(".lolliclock-ampm-btn"),this.amButton=s.find("#lolliclock-btn-am"),this.pmButton=s.find("#lolliclock-btn-pm"),this.options.hour24&&(this.AmPmButtons.hide(),this.spanAmPm.hide()),s.addClass(this.options.orientation),!h.autoclose){this.popover.css("height","380px");var u=y('<div class="lolliclock-buttons"></div>').appendTo(e);y('<div class="lolliclock-button">'+h.cancelText+"</div>").click(y.proxy(this.hide,this)).appendTo(u),y('<div class="lolliclock-button">'+h.okText+"</div>").click(y.proxy(this.done,this)).appendTo(u),this.closeButtons=s.find(".lolliclock-button")}c.on("focus.lolliclock click.lolliclock",y.proxy(this.show,this));var p,m,v,f=y('<div class="lolliclock-tick"></div>');if(h.hour24){for(p=1;p<13;p++)m=f.clone(),v=p/6*Math.PI,m.css({left:S+Math.sin(v)*N-O,top:S-Math.cos(v)*N-O}),m.html(p),l.append(m);for(p=13;p<=24;p++)m=f.clone(),v=p/6*Math.PI,m.css({left:S+Math.sin(v)*H-O,top:S-Math.cos(v)*H-O}),24===p?m.html("00"):m.html(p),l.append(m)}else for(p=1;p<13;p++)m=f.clone(),v=p/6*Math.PI,m.css({left:S+Math.sin(v)*H-O,top:S-Math.cos(v)*H-O}),m.html(p),l.append(m);for(p=0;p<60;p+=5)m=f.clone(),v=p/30*Math.PI,m.css({left:S+Math.sin(v)*H-O,top:S-Math.cos(v)*H-O}),m.html(E(p)),n.append(m);r.on(P,function(t){var i=r.offset(),o=/^touch/.test(t.type),e=i.left+S,l=i.top+S,n=(o?t.originalEvent.touches[0]:t).pageX-e,a=(o?t.originalEvent.touches[0]:t).pageY-l,s=Math.sqrt(n*n+a*a),c=!1;if(outsideMode=!0,s<H+O&&H-O<s)outsideMode=!0;else{if(!(N-O<s&&s<N+O&&h.hour24&&"hours"===d.currentView))return;outsideMode=!1}t.preventDefault(),y(document.body).addClass("lolliclock-moving"),r.append(d.canvas),d.setHand(n,a,outsideMode),y(document).off(T).on(T,function(t){t.preventDefault();var i=/^touch/.test(t.type),o=(i?t.originalEvent.touches[0]:t).pageX-e,s=(i?t.originalEvent.touches[0]:t).pageY-l;!c&&o==n&&s==a||(c=!0,d.setHand(o,s,outsideMode))}),y(document).off(x).on(x,function(t){t.preventDefault();var i=/^touch/.test(t.type),o=(i?t.originalEvent.changedTouches[0]:t).pageX-e,s=(i?t.originalEvent.changedTouches[0]:t).pageY-l;o==n&&s==a&&d.setHand(o,s,outsideMode),"hours"===d.currentView?d.toggleView("minutes",I/2):h.autoclose&&d.done(),r.prepend(k),y(document.body).removeClass("lolliclock-moving"),y(document).off(T),y(document).off(x)})});var k=s.find(".lolliclock-canvas"),g=V("svg");g.setAttribute("class","lolliclock-svg"),g.setAttribute("width",D),g.setAttribute("height",D);var w=V("g");w.setAttribute("transform","translate("+S+","+S+")");var b=V("circle");b.setAttribute("class","lolliclock-bearing"),b.setAttribute("cx",0),b.setAttribute("cy",0),b.setAttribute("r",1.25);var A=V("line");A.setAttribute("x1",0),A.setAttribute("y1",0);var C=V("circle");C.setAttribute("class","lolliclock-canvas-bg"),C.setAttribute("r",O);var M=V("circle");M.setAttribute("class","lolliclock-canvas-fg"),M.setAttribute("r",3.5),w.appendChild(A),w.appendChild(C),w.appendChild(M),w.appendChild(b),g.appendChild(w),k.append(g),this.hand=A,this.bg=C,this.fg=M,this.bearing=b,this.g=w,this.canvas=k,document.querySelector("#"+y(c).attr("id")).addEventListener("pointerdown",function(t){t.target&&t.target.setPointerCapture&&t.target.setPointerCapture(t.pointerId)}),X(this.options.init)}function X(t){t&&"function"==typeof t&&t()}l.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},l.prototype.setOrientation=function(t){this.popover.removeClass(this.options.orientation),this.options.orientation=t,this.popover.addClass(t)},l.prototype.changeAmPm=function(t){t&&t===this.amOrPm&&this.options.hour24||(this.amOrPm="AM"===this.amOrPm?"PM":"AM",this.spanAmPm.html(this.amOrPm),y(this.amButton[0].childNodes[0]).toggleClass("lolliclock-active-button-background","AM"===this.amOrPm),y(this.pmButton[0].childNodes[0]).toggleClass("lolliclock-active-button-background","PM"===this.amOrPm),y(this.amButton[0].childNodes[1]).toggleClass("lolliclock-active-button-text","AM"===this.amOrPm),y(this.pmButton[0].childNodes[1]).toggleClass("lolliclock-active-button-text","PM"===this.amOrPm))},l.prototype.locate=function(){var t=this.element,i=this.popover,o=t.offset().left+(t.outerWidth()-i.width())/2,s=y(window).width()-i.width()-8,e=y(window).height()+y(window).scrollTop()-8-i.height(),l=8+y(window).scrollTop(),n=t.offset().top,a={};a.top=n<l?l:e<n?e:n,a.left=o<8?8:s<o?s:o,i.css(a),i.show()},l.prototype.show=function(){if(!this.isShown){X(this.options.beforeShow);var t,o=this;this.popover.addClass(this.options.orientation),this.isAppended||(y(document.body).append(this.popover),this.isAppended=!0,y(window).on("resize.lolliclock"+this.id,function(){o.isShown&&o.locate()}),y(window).on("scroll.lolliclock",function(){o.isShown&&o.locate()}),this.AmPmButtons.on("click",function(t){o.changeAmPm(t.currentTarget.children[1].innerHTML)}),this.spanMinutes.on("click",function(){o.toggleView("minutes")}),this.spanHours.on("click",function(){o.toggleView("hours")}),this.spanAmPm.on("click",function(){o.changeAmPm()})),o.locate(),this.plate.addClass("animate"),this.header.addClass("animate"),this.popover.addClass("animate"),this.AmPmButtons.addClass("animate"),this.spanNewTime.addClass("animate"),this.spanOldTime.addClass("animate"),this.options.autoclose||this.closeButtons.addClass("animate"),this.plate.on("webkitAnimationEnd animationend MSAnimationEnd oanimationend",function(){o.plate.removeClass("animate"),o.header.removeClass("animate"),o.popover.removeClass("animate"),o.AmPmButtons.removeClass("animate"),o.spanNewTime.removeClass("animate"),o.spanOldTime.removeClass("animate"),o.options.autoclose||o.closeButtons.removeClass("animate"),o.plate.off("webkitAnimationEnd animationend MSAnimationEnd oanimationend")});var i=this.input.prop("value"),s=this.options.startTime,e=this.input.prop("placeholder");t=i&&n(i,this.options.hour24)?l(i,this.options.hour24):"now"===s?new Date:s&&n(s,this.options.hour24)?l(s,this.options.hour24):e&&n(e,this.options.hour24)?l(e,this.options.hour24):new Date,this.options.hour24?this.hours=t.getHours():(this.hours=t.getHours()%12,this.amOrPm=11<t.getHours()?"AM":"PM"),this.minutes=t.getMinutes(),this.changeAmPm(),o.toggleView("minutes"),o.toggleView("hours"),o.isShown=!0,y(document).on("click.lolliclock."+this.id+" focusin.lolliclock."+this.id,function(t){var i=y(t.target);0===i.closest(o.popover).length&&0===i.closest(o.input).length&&o.done()}),y(document).on("keyup.lolliclock."+this.id,function(t){27===t.keyCode&&o.hide()}),X(this.options.afterShow)}function l(t,i){var o=t.split(":");if(2===o.length){var s=+o[0],e=o[1].split(" ");if(2===e.length||i&&1===e.length){var l=e[0];return i||"PM"!==e[1]||(s+=12),new Date(1970,1,1,s,l)}}return new Date("x")}function n(t,i){return!isNaN(l(t,i).getTime())}},l.prototype.hide=function(){X(this.options.beforeHide);var t=this;t.popover.addClass("animate-out"),t.plate.addClass("animate-out"),t.header.addClass("animate-out"),t.AmPmButtons.addClass("animate-out"),t.options.autoclose||t.closeButtons.addClass("animate-out"),this.popover.on("webkitAnimationEnd animationend MSAnimationEnd oanimationend",function(){y(t.spanHours[0].childNodes[0]).html(""),y(t.spanMinutes[0].childNodes[0]).html(""),t.popover.removeClass("animate-out"),t.plate.removeClass("animate-out"),t.header.removeClass("animate-out"),t.AmPmButtons.removeClass("animate-out"),t.options.autoclose||t.closeButtons.removeClass("animate-out"),t.popover.off("webkitAnimationEnd animationend MSAnimationEnd oanimationend"),y(document).off("click.lolliclock."+t.id+" focusin.lolliclock."+t.id),y(document).off("keyup.lolliclock."+t.id),t.popover.hide(),X(t.options.afterHide)}),t.isShown=!1},l.prototype.toggleView=function(t,i){var o="hours"===t,s=o?this.hoursView:this.minutesView,e=o?this.minutesView:this.hoursView;if(this.currentView=t,this.spanHours.toggleClass("lolliclock-primary-text",o),this.spanMinutes.toggleClass("lolliclock-primary-text",!o),e.addClass("lolliclock-dial-out"),s.css("visibility","visible").removeClass("lolliclock-dial-out"),this.resetClock(i),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){e.css("visibility","hidden")},I),o)this.plate.off(T);else{var a=this;this.plate.on(T,function(t){var i=a.plate.offset(),o=i.left+S,s=i.top+S,e=t.pageX-o,l=t.pageY-s,n=Math.sqrt(e*e+l*l);H-O<n&&n<H+O?y(document.body).addClass("lolliclock-clickable"):y(document.body).removeClass("lolliclock-clickable")})}},l.prototype.resetClock=function(t){var i=this.currentView,o=!0,s=this[i];"hours"===i?(unit=Math.PI/6,0!==s&&s<=12&&this.options.hour24&&(o=!1)):unit=Math.PI/30;var e=s*unit,l=Math.sin(e)*N,n=-Math.cos(e)*N,a=this;t?(a.canvas.addClass("lolliclock-canvas-out"),setTimeout(function(){a.canvas.removeClass("lolliclock-canvas-out"),a.setHand(l,n,o)},t)):this.setHand(l,n,o)},l.prototype.setHand=function(t,i,o){var s,e,l,n=Math.atan2(-t,i)+Math.PI,a="hours"===this.currentView,c=Math.PI/(a?6:30);if(o&&this.options.hour24&&a?12===(s=Math.round(n/c))||0===s?s=0:s+=12:s=Math.round(n/c),n=s*c,a)0!==s||this.options.hour24&&o||(s=12),this.fg.style.visibility="hidden";else{var h=s%5==0;this.fg.style.visibility=h?"hidden":"visible",60===s&&(s=0)}this[this.currentView]!==s&&p&&this.options.vibrate&&(this.vibrateTimer||(navigator[p](10),this.vibrateTimer=setTimeout(y.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=s,a?(e=y(this.spanHours[0].childNodes[0]),l=y(this.spanHours[0].childNodes[1]),this.options.hour24&&(s=E(s))):(e=y(this.spanMinutes[0].childNodes[0]),l=y(this.spanMinutes[0].childNodes[1]),s=E(s)),e.on("webkitAnimationEnd animationend MSAnimationEnd oanimationend",function(){e.html(s),e.removeClass("old-down old-up"),l.removeClass("new-down new-up"),e.off("webkitAnimationEnd animationend MSAnimationEnd oanimationend")}),s<+e.html()?(l.html(e.html()),e.html(s),l.addClass("new-down"),e.addClass("old-down")):(s>+e.html()||!e.html())&&(l.html(s),e.addClass("old-up"),l.addClass("new-up")),this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","lolliclock-canvas-bg");var r=N;o&&(r=H);var d=Math.sin(n)*r,u=-Math.cos(n)*r;this.hand.setAttribute("x2",Math.sin(n)*(r-O)),this.hand.setAttribute("y2",-Math.cos(n)*(r-O)),this.bg.setAttribute("cx",d),this.bg.setAttribute("cy",u),this.fg.setAttribute("cx",d),this.fg.setAttribute("cy",u)},l.prototype.done=function(){X(this.options.beforeDone);var t=this.input.prop("value"),i="";(i=this.options.hour24?E(this.hours)+":"+E(this.minutes):this.hours+":"+E(this.minutes)+" "+this.amOrPm)!==t&&(this.input.prop("value",i),this.input.trigger("input"),this.input.trigger("change")),this.hide()},l.prototype.remove=function(){this.element.removeData("lolliclock"),this.input.off("focus.lolliclock click.lolliclock"),this.isShown&&this.hide(),this.isAppended&&(y(window).off("resize.lolliclock"+this.id),y(window).off("scroll.lolliclock"+this.id),this.popover.remove())},y.fn.lolliclock=function(s){var e=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=y(this),i=t.data("lolliclock");if(i)"function"==typeof i[s]&&i[s].apply(i,e);else{var o=y.extend({},l.DEFAULTS,t.data(),"object"==typeof s&&s);t.data("lolliclock",new l(t,o))}})}}();